---
title: 事务的四大特性与隔离级别
date: 2019-10-15 15:46:07
categories:
	数据库
tags:
	数据库
---

# 事务的四大特性与隔离级别

数据库在并发条件下，可能会出现脏读，不可重复读，幻读等问题。为了防止这些问题，我们在数据库事务中添加隔离级别来保证数据的准确性。

# 隔离级别

## 读未提交

​	一个事务读取到了其他事务为提交的数据。这是最低基本的隔离。这个隔离级别会产生脏读，不可重复读，幻读。

事例：老板给员工发工资，发了5000，却多输入了一个0，此时事务没有提交，但员工查询时发下自己工资变多了。老板发现输入错了，又事务回滚，改成5000再提交。在这里，员工查询到的工资就只脏读产生的脏数据。我们看下面的定义：

#### 	脏读：

​			事务1在操作一条记录，事务2获得了此条记录，但是事务1回滚了，事务2的得到的数据就是脏数据，这就是脏读。

#### 	不可重复读：

​			事务1读取了一条数据，但事务1没有结束，事务2修改了这一条数据，事务1再次读此条数据时，得到两次读到的数据不一致。

#### 	幻读：

​			事务1批量处理多条记录，这个时候事务2新添加或者删除多条记录，当事务1处理完毕后，发现原来数据没有处理而产生的一种幻像。



## 读已提交

 	一个事务读取到其他事务提交的数据。（Oracle默认隔离的级别），会产生不可重复读，幻读。

事例：小明去银行取钱，卡里有1万元，此时小明的妻子通过支付宝转了5000，小明再次查询时，发现卡了只有了5000元。

## 可重复读

​		 就是一个事务对同一份数据读取到的相同，不在乎其他事务对数据的修改。（MySQL默认的隔离级别。） 

## 序列化

​		事务是串行执行，牺牲了并发执行。 可以避免脏读、不可重复读与幻读。但是这种事务隔离级别效率低下，比较耗数据库性能，一般不使用。 

# 四大特性

## 原子性

事务是数据库的逻辑工作单位，事务中包含的各操作要么都做，要么都不做 。

## 一致性

 事务完成时，数据必须处于一致状态，数据的完整性约束没有被破坏，事务在执行过程中发生错误，会被回滚（Rollback）到事务开始前的状态，就像这个事务从来没   有执行过一样。 

## 隔离性

 事务允许多个用户对同一个数据进行并发访问，而不破坏数据的正确性 和完整性。同时，并行事务的修改必须与其他并行事务的修改相互独立。 

## 持久性

 事务结束后，事务处理的结果必须能够得到固化。 